# ポケモンしりとりゲーム

ポケモンの名前を使ったしりとりゲームです。Next.jsとTypeScriptで構築されています。

## 🎮 ゲーム概要

このゲームは、ポケモンの名前を使ってしりとりを楽しむWebアプリケーションです。プレイヤーは順番にポケモンの名前を入力し、前のポケモン名の最後の文字で始まるポケモン名を答えます。

### 🎯 ゲームモード
- **シングルモード**: 通常のしりとりゲーム（時間制限なし）
- **タイムアタック（TA）モード**: 60秒の制限時間内でゴールを目指す
  - 残り時間×1ptのボーナス獲得
  - 別々のハイスコア記録

### 📋 基本ルール
1. **しりとり**: 前のポケモンの最後の文字で始まるポケモン名を入力
2. **ゴール**: ランダムに選ばれたゴールポケモンを目指す
3. **重複禁止**: 一度使ったポケモンは再使用不可
4. **制限ポケモン**: フォルム違いなど一部のポケモンは使用不可

### 🏆 スコアシステム
- **基本点**: 正解1つにつき1ポイント
- **タイプコンボ**: 前のポケモンとタイプが一致すると連続コンボでボーナス点
  - コンボ数に応じて追加ポイント（1コンボ目+2pt、2コンボ目+3pt...）
- **ゴールボーナス**: ゴール到達時に+10ポイント
- **パスペナルティ**: パス使用時に-2ポイント

### ✨ 主要機能
- **パス**: 3回まで使用可能（-2ポイント、次の文字をランダム変更）
- **ヒント**: ゴールポケモンの一部を表示（使用すると記録に残る）
- **図鑑システム**: 全1025匹のポケモンをマイルストーンごとに達成表示
- **シェア機能**: ゲーム結果と図鑑進捗をX（Twitter）でシェア
- **エフェクト演出**: 進捗達成時の美しいフェードアウトクラッカー演出
- **個人統計**: 自分のプレイ記録を詳細に管理・表示
- **URLパラメータ**: `?mode=timeattack` でタイムアタック、`?start=001&goal=150` で特定問題

## 🛠️ 技術情報

### プロジェクト情報
- **デプロイ先**: GitHub Pages
- **公開URL**: https://nyama.github.io/pokeshiri-game/
- **CI/CD**: GitHub Actions（自動デプロイ、統計データ3時間ごと更新）
- **フレームワーク**: Next.js 14 (App Router)
- **UI**: Material Design風、Bootstrap対応

### 技術スタック
- **フレームワーク**: Next.js 14 (App Router)
- **言語**: TypeScript
- **スタイリング**: Tailwind CSS + Bootstrap対応
- **UIコンポーネント**: shadcn/ui (Material Design風)
- **PWA**: Service Worker
- **デプロイ**: GitHub Pages
- **CI/CD**: GitHub Actions

### プロジェクト構造
```
├── app/                    # Next.js App Router
├── components/             # Reactコンポーネント
│   ├── ui/                # UIコンポーネント
│   ├── progress-modal.tsx # 進捗達成モーダル（シェア機能付き）
│   └── ...                # ゲーム関連コンポーネント
├── lib/                   # ユーティリティとデータ
│   ├── progress-messages.ts # 進捗メッセージ管理
│   └── ...                # その他のユーティリティ
├── public/                # 静的ファイル
│   └── data/
│       └── pokemon-list.csv # ポケモンデータ（1025匹、非表示フラグ対応）
└── styles/                # スタイルファイル
```

## 📊 統計・アナリティクス

### Google Analytics 4
- **イベント追跡**: ゲームクリア・ゲームオーバー・ポケモン回答を記録
- **カスタムパラメータ**: 
  - `score`: 最終スコア
  - `chain_length`: つないだポケモン数
  - `game_mode`: ゲームモード（single/timeattack）
- **累計データ**: 全プレイヤーの統計データを収集・分析

### 全体統計（stats.json）
- **基本統計**: 総回答数、クリア数、ゲームオーバー数、クリア率、平均回答数
- **記録統計**: モード別最高スコア・最長チェーン（カスタムディメンション使用）
- **メタデータ**: サービス開始日、最終更新日時

⚠️ **注意**: カスタムディメンションが設定されていない場合は0固定値になります

### 個人統計（ローカルストレージ）
- **データ管理**: ブラウザのローカルストレージで個人記録を永続化
- **統計項目**: 遊んだゲーム数、クリア数、総回答数、モード別最高得点・最長チェーン・最高コンボ数、平均回答数/ゲーム
- **表示構成**: 統計モーダルで階層的に表示（あなたの記録 → 累計データ → 全体統計 → 記録統計）
- **UI改善**: スマホ対応の1行2項目レイアウトでコンパクト化

## 🚀 開発・運用

### セットアップ

#### 必要な環境
- Node.js 18以上
- npm または pnpm

#### インストール・起動
```bash
# 依存関係のインストール
npm install
# または
pnpm install

# 開発サーバーの起動
npm run dev
# または
pnpm dev
```

ブラウザで [http://localhost:3000](http://localhost:3000) を開いてアプリケーションを確認できます。

#### ビルド
```bash
npm run build
# または
pnpm build
```

### 開発ガイドライン

#### デザイン
- **UIフレームワーク**: Material Design風のデザインを採用
- **CSSフレームワーク**: Bootstrap使用時はBootstrapクラスを優先
- **レスポンシブ**: モバイルファーストでデザイン

#### JavaScript
- **TypeScript**: 型安全性を重視
- **コンポーネント**: React関数コンポーネントを使用

#### デプロイメント
- **自動デプロイ**: mainブランチへのpushで自動的にGitHub Pagesにデプロイ
- **統計データ**: GitHub Actionsで3時間ごとに自動更新

### GitHub Actions ワークフロー
⚠️ **重要**: 新しいワークフローを作成する前に、既存のワークフローで同じ機能が実現できないか必ず確認してください。

**現在の構成:**
- `deploy.yml`: メインデプロイ（push時）
- `update-stats.yml`: 統計更新（3時間ごと + デプロイ）

**過去の統合例:**
- `update-maximums.yml` → `update-stats.yml` に統合（機能重複のため）
- `fetch-analytics.js` + `fetch-maximums-from-dimensions.js` → `fetch-stats.js` に統合

詳細は [技術仕様書](docs/development/technical-specifications.md) を参照してください。

## 📄 ライセンス

MIT License